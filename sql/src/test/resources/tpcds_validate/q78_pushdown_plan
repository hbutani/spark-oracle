GlobalLimit 100
+- LocalLimit 100
   +- Project [ss_sold_year#101335, ss_item_sk#101341, ss_customer_sk#101342, ratio#101318, store_qty#101319, store_wholesale_cost#101320, store_sales_price#101321, other_chan_qty#101322, other_chan_wholesale_cost#101323, other_chan_sales_price#101324]
      +- Sort [ss_sold_year#101335 ASC NULLS FIRST, ss_item_sk#101341 ASC NULLS FIRST, ss_customer_sk#101342 ASC NULLS FIRST, ss_qty#101336 DESC NULLS LAST, ss_wc#101337 DESC NULLS LAST, ss_sp#101338 DESC NULLS LAST, other_chan_qty#101322 ASC NULLS FIRST, other_chan_wholesale_cost#101323 ASC NULLS FIRST, other_chan_sales_price#101324 ASC NULLS FIRST, round(CheckOverflow((promote_precision(ss_qty#101336) / promote_precision(cast(coalesce(CheckOverflow((promote_precision(cast(ws_qty#101327 as decimal(38,17))) + promote_precision(cast(cs_qty#101332 as decimal(38,17)))), DecimalType(38,17), true), 1.00000000000000000) as decimal(38,18)))), DecimalType(38,6), true), 2) ASC NULLS FIRST], true
         +- Project [ss_sold_year#101335, ss_item_sk#101341, ss_customer_sk#101342, round(CheckOverflow((promote_precision(ss_qty#101336) / promote_precision(cast(CheckOverflow((promote_precision(cast(coalesce(ws_qty#101327, 0E-18) as decimal(38,17))) + promote_precision(cast(coalesce(cs_qty#101332, 0E-18) as decimal(38,17)))), DecimalType(38,17), true) as decimal(38,18)))), DecimalType(38,6), true), 2) AS ratio#101318, ss_qty#101336 AS store_qty#101319, ss_wc#101337 AS store_wholesale_cost#101320, ss_sp#101338 AS store_sales_price#101321, CheckOverflow((promote_precision(cast(coalesce(ws_qty#101327, 0E-18) as decimal(38,17))) + promote_precision(cast(coalesce(cs_qty#101332, 0E-18) as decimal(38,17)))), DecimalType(38,17), true) AS other_chan_qty#101322, CheckOverflow((promote_precision(cast(coalesce(ws_wc#101328, 0E-18) as decimal(38,17))) + promote_precision(cast(coalesce(cs_wc#101333, 0E-18) as decimal(38,17)))), DecimalType(38,17), true) AS other_chan_wholesale_cost#101323, CheckOverflow((promote_precision(cast(coalesce(ws_sp#101329, 0E-18) as decimal(38,17))) + promote_precision(cast(coalesce(cs_sp#101334, 0E-18) as decimal(38,17)))), DecimalType(38,17), true) AS other_chan_sales_price#101324, ss_qty#101336, ss_wc#101337, ss_sp#101338, ws_qty#101327, cs_qty#101332]
            +- RelationV2[ss_sold_year#101335, ss_item_sk#101341, ss_customer_sk#101342, ss_qty#101336, ss_wc#101337, ss_sp#101338, ws_qty#101327, ws_wc#101328, ws_sp#101329, cs_sold_year#101330, cs_item_sk#101511, cs_customer_sk#101331, cs_qty#101332, cs_wc#101333, cs_sp#101334] TPCDS.STORE_SALES
