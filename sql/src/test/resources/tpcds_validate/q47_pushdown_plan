'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [CheckOverflow((cast(none#7 as decimal(38,17)) - cast(none#6 as decimal(38,17))), DecimalType(38,17), true) ASC NULLS FIRST, none#2 ASC NULLS FIRST], true
      +- 'Project [none#0, none#1, none#2, none#3, none#4, none#5, none#7, none#6, none#9 AS #0, none#14 AS #1]
         +- 'Join Inner, (((((none#3 = none#13) AND (none#0 = none#10)) AND (none#1 = none#11)) AND ((none#15 - 1) = none#8)) AND (none#2 = none#12))
            :- 'Project [none#0, none#1, none#2, none#3, none#4, none#5, none#6, none#7, none#8, none#13]
            :  +- 'Join Inner, (((((none#0 = none#9) AND (none#2 = none#11)) AND (none#3 = none#12)) AND ((1 + none#14) = none#8)) AND (none#1 = none#10))
            :     :- !Filter ((((((0.100000 < CASE WHEN (0E-22 < none#7) THEN CheckOverflow((cast(abs(CheckOverflow((cast(none#6 as decimal(38,17)) - cast(none#7 as decimal(38,17))), DecimalType(38,17), true)) as decimal(38,22)) / none#7), DecimalType(38,6), true) ELSE null END) AND isnotnull(none#8)) AND (0E-22 < none#7)) AND isnotnull(none#4)) AND isnotnull(none#7)) AND (1999.000000000000000000 = none#4))
            :     :  +- Window [rank(none#4, none#5) windowspecdefinition(none#0, none#1, none#2, none#3, none#4 ASC NULLS FIRST, none#5 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS #0], [none#0, none#1, none#2, none#3], [none#4 ASC NULLS FIRST, none#5 ASC NULLS FIRST]
            :     :     +- !Project [none#0, none#1, none#2, none#3, none#4, none#5, none#6, none#8]
            :     :        +- Window [avg(none#7) windowspecdefinition(none#0, none#1, none#2, none#3, none#4, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS #0], [none#0, none#1, none#2, none#3, none#4]
            :     :           +- RelationV2[none#0, none#1, none#2, none#3, none#4, none#5, none#6, none#7] TPCDS.ITEM
            :     +- !Project [none#0, none#1, none#2, none#3, none#6, none#7]
            :        +- !Filter isnotnull(none#7)
            :           +- Window [rank(none#4, none#5) windowspecdefinition(none#0, none#1, none#2, none#3, none#4 ASC NULLS FIRST, none#5 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS #0], [none#0, none#1, none#2, none#3], [none#4 ASC NULLS FIRST, none#5 ASC NULLS FIRST]
            :              +- RelationV2[none#0, none#1, none#2, none#3, none#4, none#5, none#6] TPCDS.ITEM
            +- !Project [none#0, none#1, none#2, none#3, none#6, none#7]
               +- !Filter isnotnull(none#7)
                  +- Window [rank(none#4, none#5) windowspecdefinition(none#0, none#1, none#2, none#3, none#4 ASC NULLS FIRST, none#5 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS #0], [none#0, none#1, none#2, none#3], [none#4 ASC NULLS FIRST, none#5 ASC NULLS FIRST]
                     +- RelationV2[none#0, none#1, none#2, none#3, none#4, none#5, none#6] TPCDS.ITEM
