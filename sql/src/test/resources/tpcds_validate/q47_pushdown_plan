GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#76290 as decimal(38,17))) - promote_precision(cast(avg_monthly_sales#76291 as decimal(38,17)))), DecimalType(38,17), true) ASC NULLS FIRST, s_store_name#76373 ASC NULLS FIRST], true
      +- Project [i_category#76307, i_brand#76303, s_store_name#76373, s_company_name#76385, d_year#76346, d_moy#76348, avg_monthly_sales#76291, sum_sales#76290, sum_sales#76669 AS psum#76293, sum_sales#76697 AS nsum#76294]
         +- Join Inner, (((((i_category#76307 = i_category#76511) AND (i_brand#76303 = i_brand#76507)) AND (s_store_name#76373 = s_store_name#76577)) AND (s_company_name#76385 = s_company_name#76589)) AND (rn#76292 = (rn#76671 - 1)))
            :- Project [i_category#76307, i_brand#76303, s_store_name#76373, s_company_name#76385, d_year#76346, d_moy#76348, sum_sales#76290, avg_monthly_sales#76291, rn#76292, sum_sales#76669]
            :  +- Join Inner, (((((i_category#76307 = i_category#76409) AND (i_brand#76303 = i_brand#76405)) AND (s_store_name#76373 = s_store_name#76475)) AND (s_company_name#76385 = s_company_name#76487)) AND (rn#76292 = (rn#76643 + 1)))
            :     :- Filter (((((isnotnull(d_year#76346) AND isnotnull(avg_monthly_sales#76291)) AND (d_year#76346 = 1999.000000000000000000)) AND (avg_monthly_sales#76291 > 0E-22)) AND (CASE WHEN (avg_monthly_sales#76291 > 0E-22) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#76290 as decimal(38,17))) - promote_precision(cast(avg_monthly_sales#76291 as decimal(38,17)))), DecimalType(38,17), true)) as decimal(38,22))) / promote_precision(avg_monthly_sales#76291)), DecimalType(38,6), true) ELSE null END > 0.100000)) AND isnotnull(rn#76292))
            :     :  +- Window [rank(d_year#76346, d_moy#76348) windowspecdefinition(i_category#76307, i_brand#76303, s_store_name#76373, s_company_name#76385, d_year#76346 ASC NULLS FIRST, d_moy#76348 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#76292], [i_category#76307, i_brand#76303, s_store_name#76373, s_company_name#76385], [d_year#76346 ASC NULLS FIRST, d_moy#76348 ASC NULLS FIRST]
            :     :     +- Project [i_category#76307, i_brand#76303, s_store_name#76373, s_company_name#76385, d_year#76346, d_moy#76348, sum_sales#76290, avg_monthly_sales#76291]
            :     :        +- Window [avg(_w0#76640) windowspecdefinition(i_category#76307, i_brand#76303, s_store_name#76373, s_company_name#76385, d_year#76346, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#76291], [i_category#76307, i_brand#76303, s_store_name#76373, s_company_name#76385, d_year#76346]
            :     :           +- RelationV2[i_category#76307, i_brand#76303, s_store_name#76373, s_company_name#76385, d_year#76346, d_moy#76348, sum_sales#76290, _w0#76640] TPCDS.ITEM
            :     +- Project [i_category#76409, i_brand#76405, s_store_name#76475, s_company_name#76487, sum_sales#76669, rn#76643]
            :        +- Filter isnotnull(rn#76643)
            :           +- Window [rank(d_year#76448, d_moy#76450) windowspecdefinition(i_category#76409, i_brand#76405, s_store_name#76475, s_company_name#76487, d_year#76448 ASC NULLS FIRST, d_moy#76450 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#76643], [i_category#76409, i_brand#76405, s_store_name#76475, s_company_name#76487], [d_year#76448 ASC NULLS FIRST, d_moy#76450 ASC NULLS FIRST]
            :              +- RelationV2[i_category#76409, i_brand#76405, s_store_name#76475, s_company_name#76487, d_year#76448, d_moy#76450, sum_sales#76669] TPCDS.ITEM
            +- Project [i_category#76511, i_brand#76507, s_store_name#76577, s_company_name#76589, sum_sales#76697, rn#76671]
               +- Filter isnotnull(rn#76671)
                  +- Window [rank(d_year#76550, d_moy#76552) windowspecdefinition(i_category#76511, i_brand#76507, s_store_name#76577, s_company_name#76589, d_year#76550 ASC NULLS FIRST, d_moy#76552 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#76671], [i_category#76511, i_brand#76507, s_store_name#76577, s_company_name#76589], [d_year#76550 ASC NULLS FIRST, d_moy#76552 ASC NULLS FIRST]
                     +- RelationV2[i_category#76511, i_brand#76507, s_store_name#76577, s_company_name#76589, d_year#76550, d_moy#76552, sum_sales#76697] TPCDS.ITEM
