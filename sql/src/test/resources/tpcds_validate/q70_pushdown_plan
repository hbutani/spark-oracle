'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [none#3 DESC NULLS LAST, CASE WHEN (none#3 = 0) THEN none#1 END ASC NULLS FIRST, none#4 ASC NULLS FIRST], true
      +- 'Project [none#0, none#1, none#2, none#3, none#7]
         +- 'Window [rank(none#6) windowspecdefinition(none#4, none#5, none#6 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS #0], [none#4, none#5], [none#6 DESC NULLS LAST]
            +- 'Aggregate [none#1, none#2, none#3L], [sum(none#0) AS #0, none#1, none#2, (cast((shiftright(none#3L, 1) & 1) as tinyint) + cast((shiftright(none#3L, 0) & 1) as tinyint)) AS #1, (cast((shiftright(none#3L, 1) & 1) as tinyint) + cast((shiftright(none#3L, 0) & 1) as tinyint)) AS #2, CASE WHEN (0 = cast((shiftright(none#3L, 0) & 1) as tinyint)) THEN none#1 END AS #3, sum(none#0) AS #4]
               +- 'Expand [List(none#0, none#1, none#2, 0), List(none#0, none#1, null, 1), List(none#0, null, null, 3)], [none#0, none#0, none#1, none#2L]
                  +- 'Project [none#1, none#4, none#3]
                     +- 'Join Inner, (none#0 = none#2)
                        :- RelationV2[none#0, none#1] TPCDS.STORE_SALES
                        +- 'Join LeftSemi, (none#2 = none#3)
                           :- RelationV2[none#0, none#1, none#2] TPCDS.STORE
                           +- Project [none#0]
                              +- !Filter ((5 >= none#3) AND isnotnull(none#3))
                                 +- Window [rank(none#2) windowspecdefinition(none#1, none#2 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS #0], [none#1], [none#2 DESC NULLS LAST]
                                    +- RelationV2[none#0, none#1, none#2] TPCDS.STORE_SALES
