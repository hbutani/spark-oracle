GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#82154 as decimal(38,17))) - promote_precision(cast(avg_monthly_sales#82155 as decimal(38,17)))), DecimalType(38,17), true) ASC NULLS FIRST, cc_name#82249 ASC NULLS FIRST], true
      +- Project [i_category#82171, i_brand#82167, cc_name#82249, d_year#82221, d_moy#82223, avg_monthly_sales#82155, sum_sales#82154, sum_sales#82572 AS psum#82157, sum_sales#82600 AS nsum#82158]
         +- Join Inner, ((((i_category#82171 = i_category#82401) AND (i_brand#82167 = i_brand#82397)) AND (cc_name#82249 = cc_name#82479)) AND (rn#82156 = (rn#82574 - 1)))
            :- Project [i_category#82171, i_brand#82167, cc_name#82249, d_year#82221, d_moy#82223, sum_sales#82154, avg_monthly_sales#82155, rn#82156, sum_sales#82572]
            :  +- Join Inner, ((((i_category#82171 = i_category#82286) AND (i_brand#82167 = i_brand#82282)) AND (cc_name#82249 = cc_name#82364)) AND (rn#82156 = (rn#82546 + 1)))
            :     :- Filter (((((isnotnull(d_year#82221) AND isnotnull(avg_monthly_sales#82155)) AND (d_year#82221 = 1999.000000000000000000)) AND (avg_monthly_sales#82155 > 0E-22)) AND (CASE WHEN (avg_monthly_sales#82155 > 0E-22) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#82154 as decimal(38,17))) - promote_precision(cast(avg_monthly_sales#82155 as decimal(38,17)))), DecimalType(38,17), true)) as decimal(38,22))) / promote_precision(avg_monthly_sales#82155)), DecimalType(38,6), true) ELSE null END > 0.100000)) AND isnotnull(rn#82156))
            :     :  +- Window [rank(d_year#82221, d_moy#82223) windowspecdefinition(i_category#82171, i_brand#82167, cc_name#82249, d_year#82221 ASC NULLS FIRST, d_moy#82223 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#82156], [i_category#82171, i_brand#82167, cc_name#82249], [d_year#82221 ASC NULLS FIRST, d_moy#82223 ASC NULLS FIRST]
            :     :     +- Project [i_category#82171, i_brand#82167, cc_name#82249, d_year#82221, d_moy#82223, sum_sales#82154, avg_monthly_sales#82155]
            :     :        +- Window [avg(_w0#82543) windowspecdefinition(i_category#82171, i_brand#82167, cc_name#82249, d_year#82221, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#82155], [i_category#82171, i_brand#82167, cc_name#82249, d_year#82221]
            :     :           +- RelationV2[i_category#82171, i_brand#82167, cc_name#82249, d_year#82221, d_moy#82223, sum_sales#82154, _w0#82543] TPCDS.ITEM
            :     +- Project [i_category#82286, i_brand#82282, cc_name#82364, sum_sales#82572, rn#82546]
            :        +- Filter isnotnull(rn#82546)
            :           +- Window [rank(d_year#82336, d_moy#82338) windowspecdefinition(i_category#82286, i_brand#82282, cc_name#82364, d_year#82336 ASC NULLS FIRST, d_moy#82338 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#82546], [i_category#82286, i_brand#82282, cc_name#82364], [d_year#82336 ASC NULLS FIRST, d_moy#82338 ASC NULLS FIRST]
            :              +- RelationV2[i_category#82286, i_brand#82282, cc_name#82364, d_year#82336, d_moy#82338, sum_sales#82572] TPCDS.ITEM
            +- Project [i_category#82401, i_brand#82397, cc_name#82479, sum_sales#82600, rn#82574]
               +- Filter isnotnull(rn#82574)
                  +- Window [rank(d_year#82451, d_moy#82453) windowspecdefinition(i_category#82401, i_brand#82397, cc_name#82479, d_year#82451 ASC NULLS FIRST, d_moy#82453 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#82574], [i_category#82401, i_brand#82397, cc_name#82479], [d_year#82451 ASC NULLS FIRST, d_moy#82453 ASC NULLS FIRST]
                     +- RelationV2[i_category#82401, i_brand#82397, cc_name#82479, d_year#82451, d_moy#82453, sum_sales#82600] TPCDS.ITEM
