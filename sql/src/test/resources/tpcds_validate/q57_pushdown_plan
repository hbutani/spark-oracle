'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort [CheckOverflow((cast(none#6 as decimal(38,17)) - cast(none#5 as decimal(38,17))), DecimalType(38,17), true) ASC NULLS FIRST, none#2 ASC NULLS FIRST], true
      +- 'Project [none#0, none#1, none#2, none#3, none#4, none#6, none#5, none#8 AS #0, none#12 AS #1]
         +- 'Join Inner, ((((none#0 = none#9) AND (none#2 = none#11)) AND ((none#13 - 1) = none#7)) AND (none#1 = none#10))
            :- 'Project [none#0, none#1, none#2, none#3, none#4, none#5, none#6, none#7, none#11]
            :  +- 'Join Inner, ((((none#0 = none#8) AND (none#1 = none#9)) AND ((1 + none#12) = none#7)) AND (none#2 = none#10))
            :     :- !Filter (((((isnotnull(none#7) AND (CASE WHEN (0E-22 < none#6) THEN CheckOverflow((cast(abs(CheckOverflow((cast(none#5 as decimal(38,17)) - cast(none#6 as decimal(38,17))), DecimalType(38,17), true)) as decimal(38,22)) / none#6), DecimalType(38,6), true) ELSE null END > 0.100000)) AND (1999.000000000000000000 = none#3)) AND isnotnull(none#3)) AND isnotnull(none#6)) AND (0E-22 < none#6))
            :     :  +- Window [rank(none#3, none#4) windowspecdefinition(none#0, none#1, none#2, none#3 ASC NULLS FIRST, none#4 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS #0], [none#0, none#1, none#2], [none#3 ASC NULLS FIRST, none#4 ASC NULLS FIRST]
            :     :     +- !Project [none#0, none#1, none#2, none#3, none#4, none#5, none#7]
            :     :        +- Window [avg(none#6) windowspecdefinition(none#0, none#1, none#2, none#3, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS #0], [none#0, none#1, none#2, none#3]
            :     :           +- RelationV2[none#0, none#1, none#2, none#3, none#4, none#5, none#6] TPCDS.ITEM
            :     +- !Project [none#0, none#1, none#2, none#5, none#6]
            :        +- !Filter isnotnull(none#6)
            :           +- Window [rank(none#3, none#4) windowspecdefinition(none#0, none#1, none#2, none#3 ASC NULLS FIRST, none#4 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS #0], [none#0, none#1, none#2], [none#3 ASC NULLS FIRST, none#4 ASC NULLS FIRST]
            :              +- RelationV2[none#0, none#1, none#2, none#3, none#4, none#5] TPCDS.ITEM
            +- !Project [none#0, none#1, none#2, none#5, none#6]
               +- !Filter isnotnull(none#6)
                  +- Window [rank(none#3, none#4) windowspecdefinition(none#0, none#1, none#2, none#3 ASC NULLS FIRST, none#4 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS #0], [none#0, none#1, none#2], [none#3 ASC NULLS FIRST, none#4 ASC NULLS FIRST]
                     +- RelationV2[none#0, none#1, none#2, none#3, none#4, none#5] TPCDS.ITEM
