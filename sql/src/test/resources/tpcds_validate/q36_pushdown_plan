GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#71214 DESC NULLS LAST, CASE WHEN (lochierarchy#71214 = 0) THEN i_category#71327 END ASC NULLS FIRST, rank_within_parent#71215 ASC NULLS FIRST], true
      +- Project [gross_margin#71213, i_category#71327, i_class#71328, lochierarchy#71214, rank_within_parent#71215]
         +- Window [rank(_w3#71343) windowspecdefinition(_w1#71341, _w2#71342, _w3#71343 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#71215], [_w1#71341, _w2#71342], [_w3#71343 ASC NULLS FIRST]
            +- Aggregate [i_category#71327, i_class#71328, spark_grouping_id#71326L], [CheckOverflow((promote_precision(sum(ss_net_profit#71238)) / promote_precision(sum(ss_ext_sales_price#71231))), DecimalType(38,6), true) AS gross_margin#71213, i_category#71327, i_class#71328, (cast((shiftright(spark_grouping_id#71326L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#71326L, 0) & 1) as tinyint)) AS lochierarchy#71214, (cast((shiftright(spark_grouping_id#71326L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#71326L, 0) & 1) as tinyint)) AS _w1#71341, CASE WHEN (cast((shiftright(spark_grouping_id#71326L, 0) & 1) as tinyint) = 0) THEN i_category#71327 END AS _w2#71342, CheckOverflow((promote_precision(sum(ss_net_profit#71238)) / promote_precision(sum(ss_ext_sales_price#71231))), DecimalType(38,6), true) AS _w3#71343]
               +- RelationV2[SS_EXT_SALES_PRICE#71231, SS_NET_PROFIT#71238, i_category#71327, i_class#71328, spark_grouping_id#71326L] TPCDS.STORE_SALES
